<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Get Started with glydet â€¢ glydet</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get Started with glydet">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">glydet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/glydet.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/custom-traits.html">Defining Custom Traits</a></li>
    <li><a class="dropdown-item" href="../articles/quantify-motifs.html">Quantifying Glycan Motifs</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Get Started with glydet</h1>
            
      

      <div class="d-none name"><code>glydet.Rmd</code></div>
    </div>

    
    
<p>Glycan derived traits are summary features calculated from individual
glycan abundances. Instead of analyzing every single glycan structure,
we combine related glycans into biologically meaningful groups. For
example, traits describing the overall level of galactosylation,
sialylation, fucosylation, or branching. These derived traits capture
broader patterns in glycosylation and reduce noise from individual
measurements.</p>
<p>Compared with analyzing raw glycan abundances (the â€œdirect traitsâ€),
using derived traits has several advantages. It simplifies the data
while keeping key biological information, making it easier to interpret
and compare across samples. Derived traits also tend to be more robust
and less affected by technical variation, and they can better highlight
biological trends or associations with phenotypes. In short, derived
traits help us see the forest rather than just the trees ğŸŒ²ğŸŒ²ğŸŒ².</p>
<p>Enter <code>glydet</code> ğŸš€â€”your toolkit for calculating derived
traits with unprecedented precision. But hereâ€™s where it gets exciting:
<code>glydet</code> brings the power of derived traits to the
glycoproteomics community for the first time, enabling
<strong>site-specific trait analysis</strong>. Plus, it features an
intuitive domain-specific language that lets you define custom traits
tailored to your research needs.</p>
<div class="section level2">
<h2 id="important-notes-before-you-start">Important Notes Before You Start<a class="anchor" aria-label="anchor" href="#important-notes-before-you-start"></a>
</h2>
<div class="section level3">
<h3 id="prerequisites">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h3>
<p>This package is built on the <a href="https://github.com/glycoverse/glyrepr" class="external-link">glyrepr</a> package, and
heavily relies on the <a href="https://github.com/glycoverse/glyexp" class="external-link">glyexp</a> package. If you
are not familiar with these two packages, we highly recommend checking
out their introductions first. Also, to fully understand the concepts
and functions in this package, it is recommended to have a basic
understanding of the <a href="https://github.com/glycoverse/glymotif" class="external-link">glymotif</a> package.</p>
</div>
<div class="section level3">
<h3 id="data-types">Data Types<a class="anchor" aria-label="anchor" href="#data-types"></a>
</h3>
<p><code>glydet</code> is designed to work with untargeted glycomics and
glycoproteomics data. Label-free quantification data is readily
supported by <code>glyread</code> and <code>glyclean</code>. For
labeling quantification like TMT, ratios between the target and
reference channels (TMT ratios) must be converted to abundance matrix
following this procedure:</p>
<ol style="list-style-type: decimal">
<li>Calculate the median of all reference channel MS2 summed intensities
from the unnormalized intensity matrix for each glycopeptide</li>
<li>Multiply the TMT ratios by the median MS2 summed intensities for
each glycopeptide</li>
</ol>
<p>This enables the quantification of different glycopeptides in the
same sample to be comparable.</p>
</div>
</div>
<div class="section level2">
<h2 id="dive-right-in-your-first-analysis">ğŸ¯ Dive Right In: Your First Analysis<a class="anchor" aria-label="anchor" href="#dive-right-in-your-first-analysis"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glycoverse.github.io/glydet/">glydet</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glycoverse.github.io/glyrepr/" class="external-link">glyrepr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glycoverse.github.io/glyexp/" class="external-link">glyexp</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glycoverse.github.io/glyclean/" class="external-link">glyclean</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'glyclean'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     aggregate</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glycoverse.github.io/glystats/" class="external-link">glystats</a></span><span class="op">)</span></span></code></pre></div>
<p>Ready to see <code>glydet</code> in action? Letâ€™s jump straight into
a real-world example that demonstrates its power! Weâ€™ll work with
<code><a href="https://glycoverse.github.io/glyexp/reference/real_experiment.html" class="external-link">glyexp::real_experiment</a></code> â€” an authentic N-glycoproteomics
dataset from 12 patients with varying liver conditions.</p>
<p>âš ï¸ <strong>Pro tip:</strong> Always preprocess your data with
<code>glyclean</code> before diving into trait analysis. This ensures
your results are as clean and reliable as your data!</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glycoverse.github.io/glyclean/reference/auto_clean.html" class="external-link">auto_clean</a></span><span class="op">(</span><span class="va">real_experiment</span><span class="op">)</span>  <span class="co"># Preprocess the data</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; â”€â”€ <span style="font-weight: bold;">Normalizing data</span> â”€â”€</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> No QC samples found. Using default normalization method based on experiment type.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Experiment type is <span style="color: #0000BB;">"glycoproteomics"</span>. Using `normalize_median()`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">âœ”</span> Normalization completed.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; â”€â”€ <span style="font-weight: bold;">Removing variables with too many missing values</span> â”€â”€</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> No QC samples found. Using all samples.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Applying preset <span style="color: #0000BB;">"discovery"</span>...</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Total removed: <span style="color: #0000BB;">24</span> (<span style="color: #0000BB;">0.56</span>%) variables.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">âœ”</span> Variable removal completed.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; â”€â”€ <span style="font-weight: bold;">Imputing missing values</span> â”€â”€</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> No QC samples found. Using default imputation method based on sample size.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Sample size &lt;= 30, using `impute_sample_min()`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">âœ”</span> Imputation completed.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; â”€â”€ <span style="font-weight: bold;">Aggregating data</span> â”€â”€</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Aggregating to <span style="color: #0000BB;">"gfs"</span> level</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">âœ”</span> Aggregation completed.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; â”€â”€ <span style="font-weight: bold;">Normalizing data again</span> â”€â”€</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> No QC samples found. Using default normalization method based on experiment type.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Experiment type is <span style="color: #0000BB;">"glycoproteomics"</span>. Using `normalize_median()`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">âœ”</span> Normalization completed.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; â”€â”€ <span style="font-weight: bold;">Correcting batch effects</span> â”€â”€</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Batch column  not found in sample_info. Skipping batch correction.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">âœ”</span> Batch correction completed.</span></span>
<span><span class="va">exp</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â”€â”€</span> <span style="font-weight: bold;">Glycoproteomics Experiment</span> <span style="color: #00BBBB;">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Expression matrix: <span style="color: #0000BB;">12</span> samples, <span style="color: #0000BB;">3979</span> variables</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Sample information fields: <span style="color: #00BB00;">group</span> <span style="color: #0000BB;">&lt;fct&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Variable information fields: <span style="color: #00BB00;">protein</span> <span style="color: #0000BB;">&lt;chr&gt;</span>, <span style="color: #00BB00;">glycan_composition</span> <span style="color: #0000BB;">&lt;comp&gt;</span>, <span style="color: #00BB00;">glycan_structure</span> <span style="color: #0000BB;">&lt;struct&gt;</span>, <span style="color: #00BB00;">protein_site</span> <span style="color: #0000BB;">&lt;int&gt;</span>, <span style="color: #00BB00;">gene</span> <span style="color: #0000BB;">&lt;chr&gt;</span></span></span></code></pre></div>
<p>Letâ€™s take a quick peek at our dataset to understand what weâ€™re
working with:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://glycoverse.github.io/glyexp/reference/get_var_info.html" class="external-link">get_var_info</a></span><span class="op">(</span><span class="va">exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3,979 Ã— 6</span></span></span>
<span><span class="co">#&gt;    variable protein glycan_composition      glycan_structure  protein_site gene </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;comp&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;struct&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> V1       P08185  <span style="color: #000000;">Hex</span>(5)<span style="color: #000000;">HexNAc</span>(4)<span style="color: #000000;">NeuAc</span>(2) <span style="color: #000000;">NeuAc</span>(??-?)<span style="color: #000000;">Hex</span>(?â€¦          176 SERPâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> V2       P04196  <span style="color: #000000;">Hex</span>(5)<span style="color: #000000;">HexNAc</span>(4)<span style="color: #000000;">NeuAc</span>(1) <span style="color: #000000;">NeuAc</span>(??-?)<span style="color: #000000;">Hex</span>(?â€¦          344 HRG  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> V3       P04196  <span style="color: #000000;">Hex</span>(5)<span style="color: #000000;">HexNAc</span>(4)         <span style="color: #000000;">Hex</span>(??-?)<span style="color: #000000;">HexNAc</span>(â€¦          344 HRG  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> V4       P04196  <span style="color: #000000;">Hex</span>(5)<span style="color: #000000;">HexNAc</span>(4)<span style="color: #000000;">NeuAc</span>(1) <span style="color: #000000;">NeuAc</span>(??-?)<span style="color: #000000;">Hex</span>(?â€¦          344 HRG  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> V5       P10909  <span style="color: #000000;">Hex</span>(6)<span style="color: #000000;">HexNAc</span>(5)         <span style="color: #000000;">Hex</span>(??-?)<span style="color: #000000;">HexNAc</span>(â€¦          291 CLU  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> V6       P04196  <span style="color: #000000;">Hex</span>(5)<span style="color: #000000;">HexNAc</span>(4)<span style="color: #000000;">NeuAc</span>(2) <span style="color: #000000;">NeuAc</span>(??-?)<span style="color: #000000;">Hex</span>(?â€¦          344 HRG  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> V7       P04196  <span style="color: #000000;">Hex</span>(5)<span style="color: #000000;">HexNAc</span>(4)         <span style="color: #000000;">Hex</span>(??-?)<span style="color: #000000;">HexNAc</span>(â€¦          345 HRG  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> V8       P04196  <span style="color: #000000;">Hex</span>(5)<span style="color: #000000;">HexNAc</span>(4)<span style="color: #000000;">dHex</span>(2)  <span style="color: #000000;">dHex</span>(??-?)<span style="color: #000000;">Hex</span>(??â€¦          344 HRG  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> V9       P04196  <span style="color: #000000;">Hex</span>(4)<span style="color: #000000;">HexNAc</span>(3)         <span style="color: #000000;">Hex</span>(??-?)<span style="color: #000000;">HexNAc</span>(â€¦          344 HRG  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> V10      P04196  <span style="color: #000000;">Hex</span>(4)<span style="color: #000000;">HexNAc</span>(4)<span style="color: #000000;">NeuAc</span>(1) <span style="color: #000000;">NeuAc</span>(??-?)<span style="color: #000000;">Hex</span>(?â€¦          344 HRG  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 3,969 more rows</span></span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://glycoverse.github.io/glyexp/reference/get_sample_info.html" class="external-link">get_sample_info</a></span><span class="op">(</span><span class="va">exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 Ã— 2</span></span></span>
<span><span class="co">#&gt;    sample group</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> C1     C    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> C2     C    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> C3     C    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> H1     H    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> H2     H    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> H3     H    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> M1     M    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> M2     M    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> M3     M    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Y1     Y    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> Y2     Y    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> Y3     Y</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://glycoverse.github.io/glyexp/reference/get_expr_mat.html" class="external-link">get_expr_mat</a></span><span class="op">(</span><span class="va">exp</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt;              C1           C2         C3           H1           H2</span></span>
<span><span class="co">#&gt; V1 6.676837e+03 2.007225e+04      13368 4.105520e+04 1.754469e+04</span></span>
<span><span class="co">#&gt; V2 3.772892e+08 5.658012e+08   99052192 2.391413e+04 1.408332e+07</span></span>
<span><span class="co">#&gt; V3 5.300372e+08 5.611186e+08  210626085 9.224067e+08 8.450856e+08</span></span>
<span><span class="co">#&gt; V4 3.006477e+09 2.649997e+09 1201420056 3.438030e+09 3.879662e+09</span></span>
<span><span class="co">#&gt; V5 2.772362e+07 3.181527e+07    8016730 6.820649e+07 4.501783e+07</span></span></code></pre></div>
<p>Now for the magic moment âœ¨â€”letâ€™s calculate some derived traits!</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trait_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/derive_traits.html">derive_traits</a></span><span class="op">(</span><span class="va">exp</span><span class="op">)</span></span>
<span><span class="va">trait_exp</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â”€â”€</span> <span style="font-weight: bold;">Traitproteomics Experiment</span> <span style="color: #00BBBB;">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Expression matrix: <span style="color: #0000BB;">12</span> samples, <span style="color: #0000BB;">3864</span> variables</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Sample information fields: <span style="color: #00BB00;">group</span> <span style="color: #0000BB;">&lt;fct&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Variable information fields: <span style="color: #00BB00;">protein</span> <span style="color: #0000BB;">&lt;chr&gt;</span>, <span style="color: #00BB00;">protein_site</span> <span style="color: #0000BB;">&lt;int&gt;</span>, <span style="color: #00BB00;">trait</span> <span style="color: #0000BB;">&lt;chr&gt;</span>, <span style="color: #00BB00;">gene</span> <span style="color: #0000BB;">&lt;chr&gt;</span>, <span style="color: #00BB00;">explanation</span> <span style="color: #0000BB;">&lt;chr&gt;</span></span></span></code></pre></div>
<p>VoilÃ ! What you see is a brand new <code><a href="https://glycoverse.github.io/glyexp/reference/experiment.html" class="external-link">experiment()</a></code> object
with â€œtraitomicsâ€ type. Think of it as your original datasetâ€™s
sophisticated cousin ğŸ­ â€” instead of tracking â€œquantification of each
glycan on each glycosite in each sample,â€ it now contains â€œthe value of
each derived trait on each glycosite in each sample.â€</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://glycoverse.github.io/glyexp/reference/get_var_info.html" class="external-link">get_var_info</a></span><span class="op">(</span><span class="va">trait_exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3,864 Ã— 6</span></span></span>
<span><span class="co">#&gt;    variable protein protein_site trait gene  explanation                        </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> V1       A6NJW9            49 TM    CD8B2 Proportion of high-mannose glycansâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> V2       A6NJW9            49 TH    CD8B2 Proportion of hybrid glycans amongâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> V3       A6NJW9            49 TC    CD8B2 Proportion of complex glycans amonâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> V4       A6NJW9            49 MM    CD8B2 Abundance-weighted mean of mannoseâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> V5       A6NJW9            49 CA2   CD8B2 Proportion of bi-antennary glycansâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> V6       A6NJW9            49 CA3   CD8B2 Proportion of tri-antennary glycanâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> V7       A6NJW9            49 CA4   CD8B2 Proportion of tetra-antennary glycâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> V8       A6NJW9            49 TF    CD8B2 Proportion of fucosylated glycans â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> V9       A6NJW9            49 TFc   CD8B2 Proportion of core-fucosylated glyâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> V10      A6NJW9            49 TFa   CD8B2 Proportion of arm-fucosylated glycâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 3,854 more rows</span></span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># These are the trait values!</span></span>
<span><span class="fu"><a href="https://glycoverse.github.io/glyexp/reference/get_expr_mat.html" class="external-link">get_expr_mat</a></span><span class="op">(</span><span class="va">trait_exp</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt;    C1 C2 C3 H1 H2</span></span>
<span><span class="co">#&gt; V1  0  0  0  0  0</span></span>
<span><span class="co">#&gt; V2  0  0  0  0  0</span></span>
<span><span class="co">#&gt; V3  1  1  1  1  1</span></span>
<span><span class="co">#&gt; V4 NA NA NA NA NA</span></span>
<span><span class="co">#&gt; V5  1  1  1  1  1</span></span></code></pre></div>
<p>ğŸ‰ <strong>Congratulations!</strong> Youâ€™ve just calculated a
comprehensive suite of derived traits in a site-specific manner:</p>
<ul>
<li>
<strong><code>TM</code></strong>: Proportion of high-mannose
glycans</li>
<li>
<strong><code>TH</code></strong>: Proportion of hybrid glycans<br>
</li>
<li>
<strong><code>TC</code></strong>: Proportion of complex glycans</li>
<li>
<strong><code>MM</code></strong>: Average number of mannoses within
high-mannose glycans</li>
<li>
<strong><code>CA2</code></strong>: Proportion of bi-antennary
glycans within complex glycans</li>
<li>
<strong><code>CA3</code></strong>: Proportion of tri-antennary
glycans within complex glycans</li>
<li>
<strong><code>CA4</code></strong>: Proportion of tetra-antennary
glycans within complex glycans</li>
<li>
<strong><code>TF</code></strong>: Proportion of fucosylated
glycans</li>
<li>
<strong><code>TFc</code></strong>: Proportion of core-fucosylated
glycans</li>
<li>
<strong><code>TFa</code></strong>: Proportion of arm-fucosylated
glycans</li>
<li>
<strong><code>TB</code></strong>: Proportion of glycans with
bisecting GlcNAc</li>
<li>
<strong><code>GS</code></strong>: Average degree of sialylation per
galactose</li>
<li>
<strong><code>AG</code></strong>: Average degree of galactosylation
per antenna</li>
<li>
<strong><code>TS</code></strong>: Proportion of sialylated
glycans</li>
</ul>
<p>ğŸ’¡ <strong>The key insight:</strong> We treat the glycans on each
glycosite as a separate mini-glycome, then calculate derived traits for
each one across all samples. For instance, if a particular glycosite
hosts 10 different glycans, the <code>TFc</code> value represents the
proportion of core-fucosylated glycans within those 10 structures in
each sample.</p>
<p><strong>Important Note:</strong> All built-in derived traits only
work for N-glycans. For other types of glycans, you need to define your
own derived traits. Check out the <a href="https://glycoverse.github.io/glydet/articles/custom-traits.html">Defining
Custom Traits</a> vignette to learn how to define your own derived
traits. In fact, for other types of glycans not so complex as N-glycans,
e.g.Â O-glycans, we recommend using <a href="https://glycoverse.github.io/glydet/articles/quantify-motifs.html">motif
quantification</a> instead.</p>
<p>Now comes the fun part! ğŸ“Š You can leverage all the powerful
functions in the <code>glystats</code> package to analyze your derived
traits. Letâ€™s demonstrate with an ANOVA analysis to identify glycosites
with significantly different levels of core-fucosylation across
conditions:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">anova_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glycoverse.github.io/glystats/reference/gly_anova.html" class="external-link">gly_anova</a></span><span class="op">(</span><span class="va">trait_exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Number of groups: <span style="color: #0000BB;">4</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Groups: <span style="color: #0000BB;">"H"</span>, <span style="color: #0000BB;">"M"</span>, <span style="color: #0000BB;">"Y"</span>, and <span style="color: #0000BB;">"C"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Pairwise comparisons will be performed, with levels coming first as reference groups.</span></span>
<span><span class="co">#&gt; Warning: <span style="color: #0000BB;">269</span> variables failed to fit the model</span></span>
<span><span class="va">anova_res</span><span class="op">$</span><span class="va">tidy_result</span><span class="op">$</span><span class="va">main_test</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">trait</span> <span class="op">==</span> <span class="st">"TFc"</span>, <span class="va">p_adj</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 Ã— 14</span></span></span>
<span><span class="co">#&gt;    variable protein protein_site trait gene   explanation    term     df   sumsq</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> V457     P00748           249 TFc   F12    Proportion ofâ€¦ group     3 5.48<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> V709     P01591            71 TFc   JCHAIN Proportion ofâ€¦ group     3 7.71<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> V919     P02679            78 TFc   FGG    Proportion ofâ€¦ group     3 3.65<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> V1115    P02765           176 TFc   AHSG   Proportion ofâ€¦ group     3 9.41<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> V1227    P02790           240 TFc   HPX    Proportion ofâ€¦ group     3 6.29<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> V1353    P03952           494 TFc   KLKB1  Proportion ofâ€¦ group     3 2.31<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> V1381    P04004            86 TFc   VTN    Proportion ofâ€¦ group     3 6.50<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> V1661    P04278           396 TFc   SHBG   Proportion ofâ€¦ group     3 2.99<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> V1675    P05090            98 TFc   APOD   Proportion ofâ€¦ group     3 1.70<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> V2165    P0C0L4          <span style="text-decoration: underline;">1</span>328 TFc   C4A    Proportion ofâ€¦ group     3 1.74<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> V2515    P19652           103 TFc   ORM2   Proportion ofâ€¦ group     3 6.44<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> V2865    P43652            33 TFc   AFM    Proportion ofâ€¦ group     3 5.47<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 5 more variables: meansq &lt;dbl&gt;, statistic &lt;dbl&gt;, p_val &lt;dbl&gt;, p_adj &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   post_hoc &lt;chr&gt;</span></span></span></code></pre></div>
<p>ğŸ” <strong>Discovery time!</strong> Weâ€™ve identified several
glycosites with statistically significant differences in
core-fucosylation levels across our patient groups â€” exactly the kind of
biological insights that make derived traits so powerful!</p>
</div>
<div class="section level2">
<h2 id="under-the-hood-understanding-meta-properties">ğŸ”§ Under the Hood: Understanding Meta-Properties<a class="anchor" aria-label="anchor" href="#under-the-hood-understanding-meta-properties"></a>
</h2>
<p>Curious about how the magic happens? Letâ€™s lift the hood and explore
<code>glydet</code>â€™s inner workingsâ€”but donâ€™t worry, weâ€™ll keep things
accessible!</p>
<p>The key concept you need to understand is
<strong>â€œmeta-propertiesâ€</strong> - think of them as the molecular
fingerprints of individual glycans.</p>
<p>ğŸ†š <strong>Whatâ€™s the difference?</strong></p>
<ul>
<li>
<strong>Derived traits</strong> describe entire glycomes (or all
glycans on a glycosite) and their values fluctuate across samples</li>
<li>
<strong>Meta-properties</strong> describe individual glycans
regardless of their abundance â€” like counting antennae,core fucoses, or
sialic acids on a single structure</li>
</ul>
<p>ğŸ§  <strong>The connection:</strong> Meta-properties are the building
blocks for derived traits. When you call <code><a href="../reference/derive_traits.html">derive_traits()</a></code>,
<code>glydet</code> automatically calculates meta-properties for all
glycans first, then uses this information to compute the derived traits
you see.</p>
<p>Want to work with meta-properties directly? ğŸ› ï¸ Youâ€™re in luck!
<code>glydet</code> provides two handy functions:</p>
<ul>
<li>
<strong><code><a href="../reference/get_meta_properties.html">get_meta_properties()</a></code></strong>: Calculate
meta-properties for any set of glycans</li>
<li>
<strong><code><a href="../reference/add_meta_properties.html">add_meta_properties()</a></code></strong>: Enrich your
<code><a href="https://glycoverse.github.io/glyexp/reference/experiment.html" class="external-link">experiment()</a></code> object by adding meta-properties to variable
information</li>
</ul>
<div class="section level3">
<h3 id="get_meta_properties">ğŸ”¬ get_meta_properties()<a class="anchor" aria-label="anchor" href="#get_meta_properties"></a>
</h3>
<p>Letâ€™s see <code><a href="../reference/get_meta_properties.html">get_meta_properties()</a></code> in action! Weâ€™ll extract
a few glycan structures from our dataset:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glycans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://glycoverse.github.io/glyexp/reference/get_var_info.html" class="external-link">get_var_info</a></span><span class="op">(</span><span class="va">exp</span><span class="op">)</span><span class="op">$</span><span class="va">glycan_structure</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="va">glycans</span></span>
<span><span class="co">#&gt; &lt;glycan_structure[5]&gt;</span></span>
<span><span class="co">#&gt; [1] <span style="color: #000000;">NeuAc</span>(??-?)<span style="color: #000000;">Hex</span>(??-?)<span style="color: #000000;">HexNAc</span>(??-?)<span style="color: #000000;">Hex</span>(??-?)[<span style="color: #000000;">NeuAc</span>(??-?)<span style="color: #000000;">Hex</span>(??-?)<span style="color: #000000;">HexNAc</span>(??-?)<span style="color: #000000;">Hex</span>(??-?)]<span style="color: #000000;">Hex</span>(??-?)<span style="color: #000000;">HexNAc</span>(??-?)<span style="color: #000000;">HexNAc</span>(??-</span></span>
<span><span class="co">#&gt; [2] <span style="color: #000000;">NeuAc</span>(??-?)<span style="color: #000000;">Hex</span>(??-?)<span style="color: #000000;">HexNAc</span>(??-?)[<span style="color: #000000;">HexNAc</span>(??-?)]<span style="color: #000000;">Hex</span>(??-?)[<span style="color: #000000;">Hex</span>(??-?)<span style="color: #000000;">Hex</span>(??-?)]<span style="color: #000000;">Hex</span>(??-?)<span style="color: #000000;">HexNAc</span>(??-?)<span style="color: #000000;">HexNAc</span>(??-</span></span>
<span><span class="co">#&gt; [3] <span style="color: #000000;">Hex</span>(??-?)<span style="color: #000000;">HexNAc</span>(??-?)<span style="color: #000000;">Hex</span>(??-?)[<span style="color: #000000;">Hex</span>(??-?)<span style="color: #000000;">HexNAc</span>(??-?)<span style="color: #000000;">Hex</span>(??-?)]<span style="color: #000000;">Hex</span>(??-?)<span style="color: #000000;">HexNAc</span>(??-?)<span style="color: #000000;">HexNAc</span>(??-</span></span>
<span><span class="co">#&gt; [4] <span style="color: #000000;">NeuAc</span>(??-?)<span style="color: #000000;">Hex</span>(??-?)<span style="color: #000000;">HexNAc</span>(??-?)<span style="color: #000000;">Hex</span>(??-?)[<span style="color: #000000;">Hex</span>(??-?)<span style="color: #000000;">HexNAc</span>(??-?)<span style="color: #000000;">Hex</span>(??-?)]<span style="color: #000000;">Hex</span>(??-?)<span style="color: #000000;">HexNAc</span>(??-?)<span style="color: #000000;">HexNAc</span>(??-</span></span>
<span><span class="co">#&gt; [5] <span style="color: #000000;">Hex</span>(??-?)<span style="color: #000000;">HexNAc</span>(??-?)<span style="color: #000000;">Hex</span>(??-?)<span style="color: #000000;">HexNAc</span>(??-?)<span style="color: #000000;">Hex</span>(??-?)[<span style="color: #000000;">Hex</span>(??-?)<span style="color: #000000;">HexNAc</span>(??-?)<span style="color: #000000;">Hex</span>(??-?)]<span style="color: #000000;">Hex</span>(??-?)<span style="color: #000000;">HexNAc</span>(??-?)<span style="color: #000000;">HexNAc</span>(??-</span></span>
<span><span class="co">#&gt; # Unique structures: 5</span></span></code></pre></div>
<p>ğŸ“ <strong>Note:</strong> <code>glycans</code> is a
<code><a href="https://glycoverse.github.io/glyrepr/reference/glycan_structure.html" class="external-link">glyrepr::glycan_structure()</a></code> vectorâ€”these are standardized
representations of glycan structures.</p>
<p>Now watch the magic happen as we calculate their meta-properties:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_meta_properties.html">get_meta_properties</a></span><span class="op">(</span><span class="va">glycans</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 Ã— 10</span></span></span>
<span><span class="co">#&gt;   Tp      B        nA    nF   nFc   nFa    nG   nGt    nS    nM</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> complex FALSE     2     0     0     0     2     0     2     3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> hybrid  FALSE     2     0     0     0     1     0     1     4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> complex FALSE     2     0     0     0     2     2     0     3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> complex FALSE     2     0     0     0     2     1     1     3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> complex FALSE     2     0     0     0     2     1     0     4</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="add_meta_properties">ğŸ“ˆ add_meta_properties()<a class="anchor" aria-label="anchor" href="#add_meta_properties"></a>
</h3>
<p>Working with <code><a href="https://glycoverse.github.io/glyexp/reference/experiment.html" class="external-link">glyexp::experiment()</a></code> objects? Perfect! You
can supercharge your variable information by adding meta-properties
directly:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exp_with_mp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_meta_properties.html">add_meta_properties</a></span><span class="op">(</span><span class="va">exp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://glycoverse.github.io/glyexp/reference/get_var_info.html" class="external-link">get_var_info</a></span><span class="op">(</span><span class="va">exp_with_mp</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3,979 Ã— 16</span></span></span>
<span><span class="co">#&gt;    variable protein glycan_composition glycan_structure protein_site gene  Tp   </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;comp&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;struct&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> V1       P08185  <span style="color: #000000;">Hex</span>(5)<span style="color: #000000;">HexNAc</span>(4)<span style="color: #000000;">Ne</span>â€¦ <span style="color: #000000;">NeuAc</span>(??-?)<span style="color: #000000;">Hex</span>(â€¦          176 SERPâ€¦ compâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> V2       P04196  <span style="color: #000000;">Hex</span>(5)<span style="color: #000000;">HexNAc</span>(4)<span style="color: #000000;">Ne</span>â€¦ <span style="color: #000000;">NeuAc</span>(??-?)<span style="color: #000000;">Hex</span>(â€¦          344 HRG   hybrâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> V3       P04196  <span style="color: #000000;">Hex</span>(5)<span style="color: #000000;">HexNAc</span>(4)    <span style="color: #000000;">Hex</span>(??-?)<span style="color: #000000;">HexNAc</span>â€¦          344 HRG   compâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> V4       P04196  <span style="color: #000000;">Hex</span>(5)<span style="color: #000000;">HexNAc</span>(4)<span style="color: #000000;">Ne</span>â€¦ <span style="color: #000000;">NeuAc</span>(??-?)<span style="color: #000000;">Hex</span>(â€¦          344 HRG   compâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> V5       P10909  <span style="color: #000000;">Hex</span>(6)<span style="color: #000000;">HexNAc</span>(5)    <span style="color: #000000;">Hex</span>(??-?)<span style="color: #000000;">HexNAc</span>â€¦          291 CLU   compâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> V6       P04196  <span style="color: #000000;">Hex</span>(5)<span style="color: #000000;">HexNAc</span>(4)<span style="color: #000000;">Ne</span>â€¦ <span style="color: #000000;">NeuAc</span>(??-?)<span style="color: #000000;">Hex</span>(â€¦          344 HRG   compâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> V7       P04196  <span style="color: #000000;">Hex</span>(5)<span style="color: #000000;">HexNAc</span>(4)    <span style="color: #000000;">Hex</span>(??-?)<span style="color: #000000;">HexNAc</span>â€¦          345 HRG   compâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> V8       P04196  <span style="color: #000000;">Hex</span>(5)<span style="color: #000000;">HexNAc</span>(4)<span style="color: #000000;">dH</span>â€¦ <span style="color: #000000;">dHex</span>(??-?)<span style="color: #000000;">Hex</span>(?â€¦          344 HRG   compâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> V9       P04196  <span style="color: #000000;">Hex</span>(4)<span style="color: #000000;">HexNAc</span>(3)    <span style="color: #000000;">Hex</span>(??-?)<span style="color: #000000;">HexNAc</span>â€¦          344 HRG   compâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> V10      P04196  <span style="color: #000000;">Hex</span>(4)<span style="color: #000000;">HexNAc</span>(4)<span style="color: #000000;">Ne</span>â€¦ <span style="color: #000000;">NeuAc</span>(??-?)<span style="color: #000000;">Hex</span>(â€¦          344 HRG   compâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 3,969 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 9 more variables: B &lt;lgl&gt;, nA &lt;int&gt;, nF &lt;int&gt;, nFc &lt;int&gt;, nFa &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   nG &lt;int&gt;, nGt &lt;int&gt;, nS &lt;int&gt;, nM &lt;int&gt;</span></span></span></code></pre></div>
<p>âœ¨ <strong>Look at that transformation!</strong> Your variable
information is now enriched with multiple meta-property columns. This
opens up powerful filtering possibilities based on structural
features.</p>
<p>For instance, letâ€™s filter for all glycoforms containing high-mannose
glycans:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exp_with_mp</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://glycoverse.github.io/glyexp/reference/filter_obs.html" class="external-link">filter_var</a></span><span class="op">(</span><span class="va">Tp</span> <span class="op">==</span> <span class="st">"highmannose"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â”€â”€</span> <span style="font-weight: bold;">Glycoproteomics Experiment</span> <span style="color: #00BBBB;">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Expression matrix: <span style="color: #0000BB;">12</span> samples, <span style="color: #0000BB;">213</span> variables</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Sample information fields: <span style="color: #00BB00;">group</span> <span style="color: #0000BB;">&lt;fct&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Variable information fields: <span style="color: #00BB00;">protein</span> <span style="color: #0000BB;">&lt;chr&gt;</span>, <span style="color: #00BB00;">glycan_composition</span> <span style="color: #0000BB;">&lt;comp&gt;</span>, <span style="color: #00BB00;">glycan_structure</span> <span style="color: #0000BB;">&lt;struct&gt;</span>, <span style="color: #00BB00;">protein_site</span> <span style="color: #0000BB;">&lt;int&gt;</span>, <span style="color: #00BB00;">gene</span> <span style="color: #0000BB;">&lt;chr&gt;</span>, <span style="color: #00BB00;">Tp</span> <span style="color: #0000BB;">&lt;fct&gt;</span>, <span style="color: #00BB00;">B</span> <span style="color: #0000BB;">&lt;lgl&gt;</span>, <span style="color: #00BB00;">nA</span> <span style="color: #0000BB;">&lt;int&gt;</span>, <span style="color: #00BB00;">nF</span> <span style="color: #0000BB;">&lt;int&gt;</span>, <span style="color: #00BB00;">nFc</span> <span style="color: #0000BB;">&lt;int&gt;</span>, <span style="color: #00BB00;">nFa</span> <span style="color: #0000BB;">&lt;int&gt;</span>, <span style="color: #00BB00;">nG</span> <span style="color: #0000BB;">&lt;int&gt;</span>, <span style="color: #00BB00;">nGt</span> <span style="color: #0000BB;">&lt;int&gt;</span>, <span style="color: #00BB00;">nS</span> <span style="color: #0000BB;">&lt;int&gt;</span>, <span style="color: #00BB00;">nM</span> <span style="color: #0000BB;">&lt;int&gt;</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="meta-property-functions-your-structural-toolkit">ğŸ§° Meta-Property Functions: Your Structural Toolkit<a class="anchor" aria-label="anchor" href="#meta-property-functions-your-structural-toolkit"></a>
</h3>
<p>Behind the scenes, meta-properties are actually functions that take
<code><a href="https://glycoverse.github.io/glyrepr/reference/glycan_structure.html" class="external-link">glyrepr::glycan_structure()</a></code> vectors and return
corresponding property values. <code>glydet</code> comes packed with a
comprehensive library of built-in meta-property functions:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="../reference/all_mp_fns.html">all_mp_fns</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "Tp"  "B"   "nA"  "nF"  "nFc" "nFa" "nG"  "nGt" "nS"  "nM"</span></span></code></pre></div>
<p>ğŸ“š <strong>Your complete toolkit:</strong> Hereâ€™s the full roster of
built-in meta-property functions:</p>
<table class="table">
<colgroup>
<col width="20%">
<col width="34%">
<col width="44%">
</colgroup>
<thead><tr class="header">
<th>Name</th>
<th>Function</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>Tp</code></td>
<td><code><a href="../reference/n_glycan_type.html">n_glycan_type()</a></code></td>
<td>Type of the glycan, either â€œcomplexâ€, â€œhybridâ€, â€œhighmannoseâ€, or
â€œpausimannoseâ€</td>
</tr>
<tr class="even">
<td><code>B</code></td>
<td><code><a href="../reference/n_glycan_type.html">has_bisecting()</a></code></td>
<td>Whether the glycan has a bisecting GlcNAc</td>
</tr>
<tr class="odd">
<td><code>nA</code></td>
<td><code><a href="../reference/n_glycan_type.html">n_antennae()</a></code></td>
<td>Number of antennae</td>
</tr>
<tr class="even">
<td><code>nF</code></td>
<td><code><a href="../reference/n_glycan_type.html">n_fuc()</a></code></td>
<td>Number of fucoses</td>
</tr>
<tr class="odd">
<td><code>nFc</code></td>
<td><code><a href="../reference/n_glycan_type.html">n_core_fuc()</a></code></td>
<td>Number of core fucoses</td>
</tr>
<tr class="even">
<td><code>nFa</code></td>
<td><code><a href="../reference/n_glycan_type.html">n_arm_fuc()</a></code></td>
<td>Number of arm fucoses</td>
</tr>
<tr class="odd">
<td><code>nG</code></td>
<td><code><a href="../reference/n_glycan_type.html">n_gal()</a></code></td>
<td>Number of galactoses</td>
</tr>
<tr class="even">
<td><code>nGt</code></td>
<td><code><a href="../reference/n_glycan_type.html">n_terminal_gal()</a></code></td>
<td>Number of terminal galactoses</td>
</tr>
<tr class="odd">
<td><code>nS</code></td>
<td><code><a href="../reference/n_glycan_type.html">n_sia()</a></code></td>
<td>Number of sialic acids</td>
</tr>
<tr class="even">
<td><code>nM</code></td>
<td><code><a href="../reference/n_glycan_type.html">n_man()</a></code></td>
<td>Number of mannoses</td>
</tr>
</tbody>
</table>
<p>Each function can be called directly for quick structural
analysis:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/n_glycan_type.html">n_glycan_type</a></span><span class="op">(</span><span class="va">glycans</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] complex hybrid  complex complex complex</span></span>
<span><span class="co">#&gt; Levels: paucimannose hybrid highmannose complex</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="working-with-structural-ambiguity">ğŸ§© Working with Structural Ambiguity<a class="anchor" aria-label="anchor" href="#working-with-structural-ambiguity"></a>
</h2>
<p>An important design principle of <code>glydet</code> is its ability
to handle glycan structures with varying levels of detail. All built-in
meta-properties and derived traits are designed to work with the
<strong>minimum information typically available</strong> for N-glycans
in most experimental scenarios.</p>
<div class="section level3">
<h3 id="generic-vs--specific-monosaccharides">ğŸ”§ Generic vs.Â Specific Monosaccharides<a class="anchor" aria-label="anchor" href="#generic-vs--specific-monosaccharides"></a>
</h3>
<p><code>glydet</code> works seamlessly with generic monosaccharide
names (e.g., â€œHexâ€, â€œHexNAcâ€, â€œdHexâ€) and structures lacking linkage
information. This level of structural resolution reflects what is
commonly achievable in glycoproteomics workflows, where complete
structural determination is often challenging.</p>
<p>For example, this ambiguous structure works perfectly:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generic monosaccharides with unknown linkages â“</span></span>
<span><span class="va">ambiguous_glycan</span> <span class="op">&lt;-</span> <span class="st">"HexNAc(??-?)Hex(??-?)[Hex(??-?)]Hex(??-?)HexNAc(??-?)[dHex(??-?)]HexNAc(??-"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="handling-detailed-structures">âœ¨ Handling Detailed Structures<a class="anchor" aria-label="anchor" href="#handling-detailed-structures"></a>
</h3>
<p>This design philosophy doesnâ€™t limit <code>glydet</code>â€™s
applicability to well-characterized structures. The package equally
handles glycans with complete structural information:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fully specified structure with specific monosaccharides and linkages âœ…</span></span>
<span><span class="va">detailed_glycan</span> <span class="op">&lt;-</span> <span class="st">"GlcNAc(b1-2)Man(a1-3)[Man(a1-6)]Man(b1-3)GlcNAc(b1-4)[Fuc(a1-6)]GlcNAc(b1-"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="extending-functionality">ğŸš€ Extending Functionality<a class="anchor" aria-label="anchor" href="#extending-functionality"></a>
</h3>
<p>When working with highly detailed structural information, you may
want to create specialized meta-property functions that leverage
specific monosaccharide identities or linkage patterns. This allows you
to define custom derived traits that capture structural features beyond
the generic framework provided by the built-in functions.</p>
</div>
</div>
<div class="section level2">
<h2 id="working-with-glycomics-data">Working with Glycomics Data<a class="anchor" aria-label="anchor" href="#working-with-glycomics-data"></a>
</h2>
<p>Working with glycomics data has no difference from working with
glycoproteomics data, even more straightforward as the resulting
<code><a href="https://glycoverse.github.io/glyexp/reference/experiment.html" class="external-link">experiment()</a></code> has a simpler structure. Here we briefly
demonstrate how to work with glycomics data using
<code><a href="https://glycoverse.github.io/glyexp/reference/real_experiment2.html" class="external-link">glyexp::real_experiment2</a></code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glycoverse.github.io/glyclean/reference/auto_clean.html" class="external-link">auto_clean</a></span><span class="op">(</span><span class="va">real_experiment2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; â”€â”€ <span style="font-weight: bold;">Removing variables with too many missing values</span> â”€â”€</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> No QC samples found. Using all samples.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Applying preset <span style="color: #0000BB;">"discovery"</span>...</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Total removed: <span style="color: #0000BB;">10</span> (<span style="color: #0000BB;">14.93</span>%) variables.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">âœ”</span> Variable removal completed.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; â”€â”€ <span style="font-weight: bold;">Normalizing data</span> â”€â”€</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> No QC samples found. Using default normalization method based on experiment type.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Experiment type is <span style="color: #0000BB;">"glycomics"</span>. Using `normalize_median_quotient()` + `normalize_total_area()`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">âœ”</span> Normalization completed.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; â”€â”€ <span style="font-weight: bold;">Normalizing data (Total Area)</span> â”€â”€</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">âœ”</span> Total area normalization completed.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; â”€â”€ <span style="font-weight: bold;">Imputing missing values</span> â”€â”€</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> No QC samples found. Using default imputation method based on sample size.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Sample size &gt; 100, using `impute_miss_forest()`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">âœ”</span> Imputation completed.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; â”€â”€ <span style="font-weight: bold;">Correcting batch effects</span> â”€â”€</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Batch column  not found in sample_info. Skipping batch correction.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">âœ”</span> Batch correction completed.</span></span>
<span><span class="va">trait_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/derive_traits.html">derive_traits</a></span><span class="op">(</span><span class="va">exp</span><span class="op">)</span></span>
<span><span class="va">trait_exp</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â”€â”€</span> <span style="font-weight: bold;">Traitomics Experiment</span> <span style="color: #00BBBB;">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Expression matrix: <span style="color: #0000BB;">144</span> samples, <span style="color: #0000BB;">14</span> variables</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Sample information fields: <span style="color: #00BB00;">group</span> <span style="color: #0000BB;">&lt;fct&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Variable information fields: <span style="color: #00BB00;">trait</span> <span style="color: #0000BB;">&lt;chr&gt;</span>, <span style="color: #00BB00;">explanation</span> <span style="color: #0000BB;">&lt;chr&gt;</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="whats-next">Whatâ€™s Next?<a class="anchor" aria-label="anchor" href="#whats-next"></a>
</h2>
<p>Now you have a good understanding of <code>glydet</code> and how to
use it. You can try <code><a href="../reference/all_traits.html">all_traits()</a></code> to calculate more advanced
and detailed derived traits. You can also start to define your own
meta-property functions and derived traits. Check out the <a href="https://glycoverse.github.io/glydet/articles/custom-traits.html">Custom
Traits</a> vignette to learn how to define your own derived traits. Or
you can check out a special type of derived traits: <a href="https://glycoverse.github.io/glydet/articles/quantify-motifs.html">motif
quantification</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bin Fu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
